<section class="container-fluid px-0">
    <!-- Banner -->
    <div class="bg-primary img_banner position-relative ">
        <img class="img_banner img-fluid " [src]="listing.coverImage" alt="Imagem de capa">
        <div class="shadow_img">
            <div class="container">
                <div class="row py-4 pt-3 pt-xl-5">
                    <div class="col-12 col-xl-1 rounded d-flex d-xl-block justify-content-center mb-2">
                        <img class="img_logo img-fluid rounded-1" [src]="listing.logoImage" alt="Imagem de logo">
                    </div>
                    <div class="col-12 col-xl-7 d-flex flex-column align-items-center align-items-xl-start px-3 text-center text-xl-start">
                        <h2 class="fs-1 text-white fw-semibold">{{ listing.title }}</h2>
                        <p class="fs-6 text-white listing_description">{{ listing.summary }}</p>
                        <span class="assessments d-flex flex-column flex-sm-row justify-content-center align-items-center gap-sm-2 mb-2 mb-sm-4 ">
                            <p class="text-white fw-bold fs-5 mb-0">5,0</p>
                            <div>
                                <i class="bi bi-star-fill fs-5"></i>
                                <i class="bi bi-star-fill fs-5"></i>
                                <i class="bi bi-star-fill fs-5"></i>
                                <i class="bi bi-star-fill fs-5"></i>
                                <i class="bi bi-star fs-5"></i>
                            </div>
                            <p class="text-white mb-0 ms-2">1 avaliação</p>
                        </span>
                        <div class="d-flex gap-2">
                            <button (click)="OpenModalUserAssessment()" class="btn btn-primary rounded-1 fw-semibold ">Avalie</button>
                            <button class="btn text-white border rounded-1 fw-semibold">Contato</button>
                        </div>
                    </div>
                    <div class="col-12 col-xl-4 d-none d-xl-block px-3">
                        @if (listing.phone) {
                            <a class="link_outline_none text-white fs-5 d-flex align-items-center mb-3" href="https://wa.me/{{listing.phone}}" target="_blank"><i class="bi bi-whatsapp me-2 fs-5"></i>
                                <span class="fs-5">{{ listing.phone }}</span>
                            </a>
                        }

                        @if (listing.address) {
                            <div class="text-white mb-3">
                                <i class="bi bi-geo-alt-fill fs-5 me-1"></i>
                                <span class="fs-5">
                                    <span *ngIf="listing.address">{{ listing.address }}</span>
                                    <span *ngIf="listing.city">, {{ listing.city }}</span>
                                    <span *ngIf="listing.state">, {{ listing.state }}</span>
                                </span>
                            </div>
                        }

                        @if (listing.email) {
                            <p class="text-white fs-5 d-flex align-items-center "><i class="bi bi-envelope me-2"></i>{{listing.email}}</p>
                        }
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- about -->
    <div class="container">
        <div class="col-12 py-4 d-xl-none">
            <a class="link_outline_none text-dark fs-5 fw-semibold d-flex align-items-center mb-3" href="https://wa.me/{{listing.phone}}" target="_blank"><i class="bi bi-whatsapp me-2 fs-5"></i>
                <span class="fs-6 fw-semiboldt custom-dark">{{listing.phone}}</span>
            </a>
            @if (listing.address) {
                <div class="custom-dark fw-semibold mb-3">
                    <i class="bi bi-geo-alt-fill fs-6 me-1"></i>
                    <span class="fs-6">
                        <span *ngIf="listing.address">{{ listing.address }}</span>
                        <span *ngIf="listing.city">, {{ listing.city }}</span>
                        <span *ngIf="listing.state">, {{ listing.state }}</span>
                    </span>
                </div>
            }
            @if (listing.email) {
                <p class="custom-dark fs-6 fw-semibold d-flex align-items-center text-break"><i class="bi bi-envelope me-2"></i>{{listing.email}}</p>
            }
        </div>
    </div>
    <div class="container mb-5">
        <div class="row my-xl-5 justify-content-between">
            <div class="col-12 col-lg-8 px-3 mb-3">
                <!-- about -->
                <h3 class="mb-3 custom-dark fw-bold">Sobre</h3>

                <div class="long_description opacity-75 mb-5">
                    <p class="custom-dark">
                        {{listing.description}}
                    </p>
                </div>

                <hr class="custom-hr-dark">

                <!-- Gallery image -->
                @if(galleryImages.length) {
                    <h3 class="custom-dark fw-bold my-4">Galeria</h3>

                    <div class="container mb-4">
                        <div class="row">
                            @for (img of galleryImages; track $index) {
                                <div class="col-6 col-sm-4 p-1 cursor_pointer" (click)="openLightbox($index)"  >
                                    <div class="">
                                        <img class="img-gallery" [src]="img" alt="Imagem">
                                    </div>
                                </div>
                            } 
                        </div>
                    </div>

                    <hr class="custom-hr-dark">
                }
            </div>

            @if(listing.openingHours) {
                <div class="col-12 col-lg-4 p-0">
                    <div class="px-3">
                        <div class="shadow rounded-2">
                            <div class="p-4 bg-ice-white">
    
                                @if (isDayOpen()) {
                                    <p class="letter-spacing-1 text-primary fw-semibold mb-1">ABERTO AGORA</p>
                                } @else {
                                    <p class="letter-spacing-1 text-danger fw-semibold mb-1">FECHADO AGORA</p>
                                }
    
                                <div class="w-100 d-flex align-items-center justify-content-between">
                                    <h4 class="custom-dark fw-bold">Horário de funcionamento</h4>
                                    <i class="fa-regular fa-clock"></i>
                                </div>
                            </div>
                            <div class="d-flex flex-column p-4">
                                @for (day of daysOfWeek; track $index) {
                                    <div>
                                        <div class="d-flex justify-content-between mb-2">
                                            <span>{{ day }}</span>
                                        
                                            @if(openingHours[day]) {
    
                                                @if(!openingHours[day].open || !openingHours[day].close) {
                                                    <span>Fechado</span>
                                                } @else {
                                                    <span>
                                                        {{ openingHours[day].open }} - {{ openingHours[day].close }}
                                                    </span>
                                                }
                                            }
                                        
                                            @if(!openingHours[day]) {
                                                <span>Horário não definido</span>
                                            }
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
        
        <div>
            <h5 class="text-dark text-opacity-50 my-5">Comentários</h5>
            <div class="container">
                <div class="row">
                    <div class="col-12 d-flex mb-4">
                        <div>
                            <img class="img-fluid rounded-circle img_user" src="../../../assets/img/no-image-user.jpg" alt="Usuário">
                        </div>
                        <div class="">
                            <div class="ms-3">
                                <h6 class="fs-6 fw-semibold text-primary text-opacity-75 mb-0">Douglas Martins</h6>
                                <div class="d-sm-flex align-items-center mb-2">
                                    <span class="text-dark opacity-75 fs-7">18 de janeiro 2024</span>
                                    <div class="ms-0 ms-sm-2 user_assessments">
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star fs-6"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="custom-dark opacity-75 fs-7">Ótimos profissionais, minha maquina de lavar esta perfeita agora.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 d-flex">
                        <div>
                            <img class="img-fluid rounded-circle img_user" src="../../../assets/img/no-image-user.jpg" alt="Usuário">
                        </div>
                        <div class="">
                            <div class="ms-3">
                                <h6 class="fs-6 fw-semibold text-primary text-opacity-75 mb-0">Tatiane Oliva</h6>
                                <div class="d-sm-flex align-items-center mb-2">
                                    <span class="text-dark opacity-75 fs-7">14 de janeiro 2024</span>
                                    <div class="ms-0 ms-sm-2 user_assessments">
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star-fill fs-6"></i>
                                        <i class="bi bi-star fs-6"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="custom-dark opacity-75 fs-7">Minha geladeira esta gelando muito agora, está ótimo</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <ng-template #modalAssessment let-c="close" let-d="dismiss">
        <div class="position-relative banner_assessment mb-5">
            <img class="img-fluid rounded-top h-100" [src]="listing.coverImage" alt="Imagem de capa">
            <i class="fs-4 bi bi-x-lg position-absolute close_modal_assessment text-white cursor_pointer" aria-label="Close" (click)="d('Cross click')"></i>
            <img class="img-fluid rounded-pill position-absolute logo_assessments" [src]="listing.logoImage" alt="Imagem de logo">
            <div class="shadow_img_assessments"></div>
        </div>

        <h5 class="fs-3 text-dark fw-semibold opacity-75 text-center">{{ listing.title }}</h5>
        <h6 class="fs-4 text-dark fw-semibold opacity-75 text-center">Sua nota</h6>
        <div class="d-flex justify-content-center user_assessments">
            <ng-container *ngFor="let _ of [].constructor(totalStars); let i = index">
              <i [class]="(i + 1 <= (hoverStars || selectedStars) ? hoverIcon : currentIcon) + ' fs-3 cursor_pointer'" 
                 (click)="selectStars(i + 1)" 
                 (mouseover)="hoverStar(i + 1)" 
                 (mouseout)="resetHover()"></i>
            </ng-container>
        </div>
        <p *ngIf="notAssessment" class="text-center mb-0 text-danger fw-semibold opacity-75">Sua nota é importante.</p>

        <form [formGroup]="formAssessment" (ngSubmit)="submitAssessment()" class="p-4">
            <textarea maxlength="130" (input)="countCaracterComment()" #commentAssessment class="form-control custom_focus custom_placeholder" name="comment" id="comment" placeholder="Seu comentário" rows="4" formControlName="comment" [ngClass]="{'invalid_input': formAssessment.get('comment')?.invalid && formAssessment.get('comment')?.touched}"></textarea>
            <p class="mt-1 fw-semibold opacity-50 text-dark max_caracter text-end">{{ currentLengthComment }} caracteres restantes</p>
            <div *ngIf="formAssessment.get('comment')?.invalid && formAssessment.get('comment')?.touched" class="text-danger fw-semibold opacity-75">
                Digite seu comentário.
            </div>
            <div class="d-flex gap-2 justify-content-center mt-3">
                <button class="btn btn-primary rounded-1 fw-semibold">Enviar</button>
                <button type="button" class="btn btn-light rounded-1 text-dark fw-semibold opacity-75 border" aria-label="Close" (click)="d('Cross click')">Cancelar</button>
            </div>
        </form>
    </ng-template>
</section>
<app-footer></app-footer>

<!-- <app-alerts *ngFor="let alerts of alert" [type]="alerts.type" [description]="alerts.description"></app-alerts> -->